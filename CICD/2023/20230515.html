<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.33">
    <script src="https://at.alicdn.com/t/font_2849934_v6y652peian.js"></script><link href="/avatar.jpg" rel="icon"><link rel="stylesheet" type="text/css" href="//at.alicdn.com/t/font_2932340_r7zitafg82.css"><title>Jenkins 零基础入门 | 星空</title><meta name="description" content="">
    <link rel="preload" href="/assets/js/runtime~app.c40023e3.js" as="script"><link rel="preload" href="/assets/css/styles.a4af0a64.css" as="style"><link rel="preload" href="/assets/js/4594.367318cd.js" as="script"><link rel="preload" href="/assets/js/app.60259080.js" as="script">
    <link rel="stylesheet" href="/assets/css/styles.a4af0a64.css">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><div class="common" style="--borderRadius:10px;--opacity:1;--fontColor:#2c3e50;--fontFamily:-apple-system;--fitter-blue:1px;"><header ref_key="navbar" style="--borderRadius:10px;--opacity:1;--fontColor:#2c3e50;--fontFamily:-apple-system;--fitter-blue:1px;" class="header-bg-show navbar" id="c-navbar"><div class="toggle-sidebar-button"><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><span><a href="/" class=""><img style="border-radius:30px;" class="logo" src="/avatar.jpg" alt="星空"><span class="site-name" style="color: #2c3e50;">星空</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><!--[--><span class="aurora-navbar-hua2 aurora-nav-font aurora-navbar-icon"></span><a href="/about" class="nav-link nav-link-active" aria-label="个人介绍">个人介绍</a><!--]--></div><div class="navbar-links-item"><div class="dropdown-wrapper"><span class="aurora-navbar-a-ziyuan107 aurora-nav-font aurora-navbar-icon"></span><button class="dropdown-title" type="button" aria-label="page"><span class="title">page</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="page"><span class="title">page</span><span class="right arrow"></span></button><ul style="display:none;" id="c-nav-dropdown" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>标签</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><!--[--><!----><a href="/tag" class="nav-link" aria-label="tag">tag</a><!--]--></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>时间轴</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><!--[--><!----><a href="/archive" class="nav-link" aria-label="archive">archive</a><!--]--></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-links-item"><!--[--><span class="aurora-navbar-guide aurora-nav-font aurora-navbar-icon"></span><a href="/link" class="nav-link nav-link-active" aria-label="友情链接">友情链接</a><!--]--></div><div class="navbar-links-item"><!--[--><span class="aurora-navbar-github1 aurora-nav-font aurora-navbar-icon"></span><a class="nav-link external nav-link-active" href="https://github.com/yuan5379/yuan5379.github.io" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github<!--[--><!--]--></a><!--]--></div><!--]--></nav><!--[--><!--]--><!----><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--[--><div id="" class="mobile-sidebar-control"></div><div id="" class="mobileAnimate mobile-sidebar"><!----></div><!--]--><div class="setColor" style="--borderRadius:10px;--fontFamily:-apple-system;--fontColor:#2c3e50;"><div id="setIco" class="setIco bg_color"></div><div class="welcome-parent" id="welcome-parent"><div class="custom-about m-4 p-4 f4 color-shadow-small bg-gray-800-mktg rounded-2 signup-content-container welcome" style="display: none;" id="welcome"><span class="cancel aurora-iconfont-common aurora-style-cancel" id="cancel"></span><h1 class="common-style" id="sr-only-h2"></h1><div class="custom-top custom-common"><div class="custom-top-span custom-common-span"><span class="aurora-iconfont-common aurora-style-img home-welcome-custom-icon"></span>  </div><div class="custom-top-span custom-common-span"><span class="aurora-iconfont-common aurora-style-blur home-welcome-custom-icon"></span>  </div></div><div class="custom-bottom custom-common"><div style="flex:1;" class="custom-bottom-span custom-common-span"><!--[--><li class="custom-li"><span style="background-color: #2c3e50;" data-color="#2c3e50"></span></li><li class="custom-li"><span style="background-color: #42a5f5;" data-color="#42a5f5"></span></li><li class="custom-li"><span style="background-color: #8093f1;" data-color="#8093f1"></span></li><li class="custom-li"><span style="background-color: #FF6EC7;" data-color="#FF6EC7"></span></li><li class="custom-li"><span style="background-color: #FF7F00;" data-color="#FF7F00"></span></li><li class="custom-li"><span style="background-color: #8FBC8F;" data-color="#8FBC8F"></span></li><li class="custom-li"><span style="background-color: #EAADEA;" data-color="#EAADEA"></span></li><li class="custom-li"><span style="background-color: #3299CC;" data-color="#3299CC"></span></li><!--]--></div></div><div class="custom-bottom custom-common"><div style="flex:1;" class="custom-bottom-span custom-common-span"><!--[--><li class="custom-li"><span style="font-family: -apple-system;" data-color="-apple-system">程</span></li><li class="custom-li"><span style="font-family: hlt;" data-color="hlt">程</span></li><li class="custom-li"><span style="font-family: tzt;" data-color="tzt">程</span></li><li class="custom-li"><span style="font-family: sst;" data-color="sst">程</span></li><li class="custom-li"><span style="font-family: lf;" data-color="lf">程</span></li><li class="custom-li"><span style="font-family: xsf;" data-color="xsf">程</span></li><li class="custom-li"><span style="font-family: lsf;" data-color="lsf">程</span></li><li class="custom-li"><span style="font-family: cgt;" data-color="cgt">程</span></li><!--]--></div></div><div class="custom-bottom custom-common"><div class="custom-bottom-span custom-common-span"> 圆角 </div><div style="flex:3;" class="custom-bottom-span custom-common-span"><div class="input-range"><div class="input-left"><input autocomplete min="1" max="40" value="10" step="1" type="range"></div><div class="input-right">10</div></div></div></div><div class="custom-bottom custom-common"><div class="custom-bottom-span custom-common-span"> 透明度 </div><div style="flex:3;" class="custom-bottom-span custom-common-span"><div class="input-range"><div class="input-left"><input autocomplete min="0" max="1" value="1" step="0.01" type="range"></div><div class="input-right">1</div></div></div></div></div></div></div><!--[--><!--]--><!--[--><!--]--><!--[--><!--]--><!--[--><!--]--><!--[--><!--]--><!--[--><!--]--><div style="--fontColor: #2c3e50; --fontFamily: -apple-system;" class="sidebar-single-enter-animate theme-container"><div class="page-sidebar"><div class="sidebar-single-enter-animate page-top" id="page-top" show-mood-edit="false"><div class="top-mask" style="background-image: url(/bg/555260.png);"></div><div class="aurora-top-bubble"><div class="aurora-top-bubble-par"><div class="aurora-top-bubble-box" id="aurora-top-bubble-box"></div><canvas class="aurora-top-bubble-canvas" id="aurora-top-bubble-canvas"></canvas></div></div><!--[--><!--]--><!--[--><!--]--><!--[--><!--]--><!--[--><!--]--><!--[--><!--]--><div class="page-record-control"><div class="page-top-record" id="page-top-record"><div class="page-record-bot-common page-record-top"><div class="page-record-top-left page-record-single-common"><span class="aurora-iconfont-common aurora-page-word"></span>  <span class="page-record-single-desc">总字数</span><span>0</span></div><div class="page-record-top-right page-record-single-common"><span class="aurora-iconfont-common aurora-page-time"></span>  <span class="page-record-single-desc">时长</span><span>0</span></div></div><div class="page-record-bot-common page-record-center"><div class="page-record-center-left page-record-single-common"><span class="aurora-iconfont-common aurora-page-comment"></span>  <span class="page-record-single-desc">评论数</span><span id="/CICD/2023/20230515.html" class="waline-comment-count"></span></div><div class="page-record-center-right page-record-single-common"><span class="aurora-iconfont-common aurora-page-read"></span>  <span class="page-record-single-desc">总阅读数</span><span id="/CICD/2023/20230515.html" class="waline-visitor-count"></span></div></div><!----></div></div><div class="top-image" id="top-image"><h1></h1></div></div><div class="content"><div id="article-page-parent" class="article-page-parent-pro article-page-parent"><div class="noShowSidebar page-sidebar-left" id="page-sidebar-left"><!--[--><!--]--><!--[--><!--[--><main style="--borderRadius: 10px;--opacity: 1;" class="page sidebar-single-enter-animate" id="article-page"><!--[--><!--]--><div id="theme-default-content" class="show-h1-tag theme-default-content pageContent medium-zoom-content"><div class="page-top-share"><div class="page-top-share-next"><div class="poster-share" style="z-index:99;"><div class="poster-button" id="poster-button"><span class="aurora-iconfont-common aurora-poster-ico" data="2">生成海报3</span>  </div></div></div></div><!--[--><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>公司的前端构建及部署工作都是人工去做，随着业务扩大，项目迭代速度变快，人员增多，各种问题都暴露出来，本文是对前端自动化工作流进行探索后的一篇经验分享，将通过一个简单案例分享一下基于Jenkins的前端自动化工作流搭建的过程，搭建完这套工作流，我们只需要在本地发起一个git提交，剩下的单元测试，打包构建，代码部署，邮件提醒等功能全部自动化完成，让持续集成、持续交付、持续部署变得简单易操作，真正解决人工构建部署的诸多问题</p></div><h2 id="jenkins是什么" tabindex="-1"><a class="header-anchor" href="#jenkins是什么" aria-hidden="true">#</a> Jenkins是什么？</h2><p>Jenkins 是一款业界流行的开源持续集成工具，广泛用于项目开发，具有自动化构建、测试和部署等功能。</p><h2 id="本案例要实现的功能" tabindex="-1"><a class="header-anchor" href="#本案例要实现的功能" aria-hidden="true">#</a> 本案例要实现的功能</h2><p>本地项目发起一个git提交，剩下的单元测试，打包构建，代码部署，邮件提醒等全部自动化完成。</p><h2 id="准备工作" tabindex="-1"><a class="header-anchor" href="#准备工作" aria-hidden="true">#</a> 准备工作</h2><ol><li>先准备一个项目，我这里直接使用vue-cli脚手架生成了一个项目，其他技术栈也一样，只要是个项目就行。</li></ol><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="vue-cli生成的项目" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/14/162c3fb8f8a9d41f~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="vue-cli生成的项目" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/14/162c3ff9ebf6319e~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p><p>\2. 建立这个项目的远端git仓库，并把本地代码提交上去。我这里用的码云，github也一致。 \3. 准备一台能外网访问的服务器，非要用你自己的电脑当服务器也可以，保证外网可访问即可。我这里用的是阿里云ubantu14.04，另外，阿里云新手注册有一个月的免费服务器可领，不想花钱的可以试一下。 \4. 服务器上配好Java环境。</p><h2 id="jenkins的安装与启动" tabindex="-1"><a class="header-anchor" href="#jenkins的安装与启动" aria-hidden="true">#</a> Jenkins的安装与启动</h2><p>linux下：<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Ffenglailea%2Farticle%2Fdetails%2F25919367" target="_blank" rel="noopener noreferrer">ubuntu 14.04中安装Jenkins<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!----></span></a> windows下：</p><ol><li>从Jenkins官网下载最新war文件。</li><li>运行<code>java -jar jenkins.war</code>即可。</li></ol><h2 id="jenkins初始化" tabindex="-1"><a class="header-anchor" href="#jenkins初始化" aria-hidden="true">#</a> Jenkins初始化</h2><ol><li>jenkins的默认端口是8080,启动成功后在浏览器打开。</li><li>进入后会让我们输管理员密码，打开网页上提示路径下的文件，复制密码粘贴输入即可。</li><li>然后会让安装需要的插件，此处选默认即可，等待安装完成。</li><li>创建一个管理员账户。</li><li>上面都完成后会看到这个界面。</li></ol><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="Jenkins初始化完成" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/14/162c486771d8309c~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p><h2 id="创建任务" tabindex="-1"><a class="header-anchor" href="#创建任务" aria-hidden="true">#</a> 创建任务</h2><ol><li><p>点击创建一个新任务</p><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="新任务" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/14/162c48a03fd6dfdd~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p></li><li><p>选择自由风格的软件项目，并起一个名字</p><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="自由风格的软件项目" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/14/162c48a7c39e576f~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p></li></ol><p>至此，基础准备工作已经完成，我们在服务器上安装了Jenkins并启动，然后进行了初始化配置，建立了一个新任务。接下来我们开始配置我们需要的功能。</p><h2 id="实现git钩子功能" tabindex="-1"><a class="header-anchor" href="#实现git钩子功能" aria-hidden="true">#</a> 实现git钩子功能</h2><p>首先我们要实现一个git钩子功能，就是我们向github/码云等远程仓库push我们的代码时，jenkins能知道我们提交了代码，这是自动构建自动部署的前提，钩子的实现原理是在远端仓库上配置一个Jenkins服务器的接口地址，当本地向远端仓库发起push时，远端仓库会向配置的Jenkins服务器的接口地址发起一个带参数的请求，jenkins收到后开始工作。</p><ol><li><p>打开刚创建的任务，选择配置，添加远程仓库地址，配置登录名及密码及分支。</p><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="添加仓库地址" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/14/162c4b63c9152782~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p></li><li><p>安装Generic Webhook Trigger Plugin插件（系统管理-插件管理-搜索Generic Webhook Trigger Plugin）如果可选插件列表为空，点击高级标签页，替换升级站点的URL为：<code>http://mirror.xmission.com/jenkins/updates/update-center.json</code>并且点击提交和立即获取。</p></li><li><p>添加触发器</p><p>第2步安装的触发器插件功能很强大，可以根据不同的触发参数触发不同的构建操作，比如我向远程仓库提交的是master分支的代码，就执行代码部署工作，我向远程仓库提交的是某个feature分支，就执行单元测试，单元测试通过后合并至dev分支。灵活性很高，可以自定义配置适合自己公司的方案，这里方便演示我们不做任何条件判断，只要有提交就触发。在任务配置里勾选Generic Webhook Trigger即可</p><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="添加触发器" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/14/162c4c36ea15b935~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p></li><li><p>仓库配置钩子 此处以码云为例，因为公司用的是码云，github的配置基本一致，进入码云项目主页后，点击管理-webhooks-添加，会跳出一个这样的框来。</p><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="仓库配置钩子" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/14/162c4cfe042bba32~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p><p>URL格式为</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>http://&lt;User ID&gt;:&lt;API Token&gt;@&lt;Jenkins IP地址&gt;:端口/generic-webhook-trigger/invoke
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>userid和api token在jenkins的系统管理-管理用户-admin-设置里，这是我的</p><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="URL格式" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/14/162c4d8b530af3a0~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p><p>Jenkins IP地址和端口是你部署jenkins服务器的ip地址，端口号没改过的话就是8080。</p><p>密码填你和上面userid对应的密码，我这里是root。</p><p>下面的几个选项是你在仓库执行什么操作的时候触发钩子，这里默认用push。</p><p>点击提交完成配置。</p></li><li><p>测试钩子</p><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="测试钩子" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/14/162c4df2c9b49941~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p><p>点击测试，如果配置是成功的，你的Jenkins左侧栏构建执行状态里将会出现一个任务。</p></li></ol><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="测试钩子" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/15/162c4e3169a3c1f3~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p><p>另外，你也可以试下本地提交代码，提交代码后，jenkins也会开始一个任务,目前我们没有配置任务开始后让它做什么，所以默认它只会在你提交新代码后，将新代码拉取到jenkins服务器上。到此为止，git钩子我们配置完成。</p><p>gif效果图：</p><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="完整效果图" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/15/162c7630b81b74c9~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p><h2 id="实现自动化构建" tabindex="-1"><a class="header-anchor" href="#实现自动化构建" aria-hidden="true">#</a> 实现自动化构建</h2><p>git push触发钩子后，jenkins就要开始工作了，自动化的构建任务可以有很多种，比如说安装升级依赖包，单元测试，e2e测试，压缩静态资源，批量重命名等等，无论是npm script还是webpack，gulp之类的工作流，你之前在本地能做的，在这里同样可以做。 作为演示，这里只演示三个基本常用的工作流程，安装依赖包-&gt;单元测试-&gt;打包，也就是下面这三个命令。</p><div class="language-arduino ext-arduino line-numbers-mode"><pre class="language-arduino"><code>arduino复制代码npm install
npm <span class="token builtin">run</span> test
npm <span class="token builtin">run</span> build
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol><li><p>首先，和本地运行npm script一样，我们要想在jenkins里面执行npm命令，先要在jenkins里面配置node的环境，可以通过配置环境变量的方式引入node，也可以通过安装插件的方式，这里使用了插件的方式，安装一下nvm wrapper这个插件。</p></li><li><p>打开刚刚的jenkins任务，点击配置里面的构建环境，勾选这个，并指定一个node版本。</p><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="构建环境" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/15/162c7726c4fc17ba~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p></li><li><p>点击构建，把要执行的命令输进去，多个命令使用&amp;&amp;分开。</p></li></ol><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="执行的命令" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/15/162c7771ae212268~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p><p>\4. 保存。 \5. 此时本地修改一下代码push测试一下（也可以点击立即构建测试），点击本次触发的那个任务，选择控制台输出，将会看到Jenkins在云端执行的过程。</p><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="云端执行的过程" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/15/162c77e6e52b6a0c~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p><p>命令行最后一行是Finished状态的如果是SUCCESS（蓝色）则证明执行的任务都顺利进行，是FAILURE（红色）则证明中间有重大错误导致任务失败，UNSTABLE（黄色）代表有虽然有些小问题，但不阻碍任务进行，黄色或者红色可以去命令行看下错误输出，看下哪里出了问题。</p><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="状态" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/15/162c783645ca6071~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p><p>\6. 如果上一步是SUCCESS，点击项目的工作空间，将会发现多了dist和node_modules两个文件夹。</p><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="文件夹" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/15/162c78ab9b46a7c6~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p><p>至此，我们已经搭建了一个简易的构建工作流程，构建完成了，我们需要自动化部署。</p><h2 id="实现自动化部署" tabindex="-1"><a class="header-anchor" href="#实现自动化部署" aria-hidden="true">#</a> 实现自动化部署</h2><p>自动化部署可能是我们最需要的功能了，公司就一台服务器，我们可以使用人工部署的方式，但是如果公司有100台服务器呢，人工部署就有些吃力了，而且一旦线上出了问题，回滚也很麻烦。所以这一节实现一下自动部署的功能。</p><ol><li>首先，先在Jenkins上装一个插件Publish Over SSH，我们将通过这个工具实现服务器部署功能。</li><li>在要部署代码的服务器上创建一个文件夹用于接收Jenkins传过来的代码，我在服务器上建了一个testjenkins的文件夹。</li><li>Jenkins想要往服务器上部署代码必须登录服务器才可以，这里有两种登录验证方式，一种是ssh验证，一种是密码验证，就像你自己登录你的服务器，你可以使用ssh免密登录，也可以每次输密码登录，系统管理-系统设置里找到Publish over SSH这一项。 重点参数说明：</li></ol><div class="language-vbnet ext-vbnet line-numbers-mode"><pre class="language-vbnet"><code>vbnet复制代码Passphrase：密码（<span class="token keyword">key</span>的密码，没设置就是空）
Path <span class="token keyword">to</span> <span class="token keyword">key</span>：<span class="token keyword">key</span>文件（私钥）的路径
<span class="token keyword">Key</span>：将私钥复制到这个框中<span class="token punctuation">(</span>path <span class="token keyword">to</span> <span class="token keyword">key</span>和<span class="token keyword">key</span>写一个即可<span class="token punctuation">)</span>

SSH Servers的配置：
SSH Server <span class="token keyword">Name</span>：标识的名字（随便你取什么）
Hostname：需要连接ssh的主机名或<span class="token function">ip</span>地址（建议<span class="token function">ip</span>）
Username：用户名
Remote Directory：远程目录（上面第二步建的testjenkins文件夹的路径）

高级配置：
<span class="token function">Use</span> password authentication<span class="token punctuation">,</span> <span class="token keyword">or</span> <span class="token function">use</span> a different <span class="token keyword">key</span>：勾选这个可以使用密码登录，不想配ssh的可以用这个先试试
Passphrase <span class="token operator">/</span> Password：密码登录模式的密码
Port：端口（默认<span class="token number">22</span>）
<span class="token function">Timeout</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span>：超时时间（毫秒）默认<span class="token number">300000</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>配置完成后，点击Test Configuration测试一下是否可以连接上，如果成功会返回success，失败会返回报错信息，根据报错信息改正即可。</p><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="返回信息" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/15/162c7bb52a7713be~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p><p>\4. 接下来进入我们创建的任务，点击构建，增加2行代码，意思是将dist里面的东西打包成一个文件，因为我们要传输。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>bash复制代码cd dist<span class="token operator">&amp;&amp;</span>
<span class="token function">tar</span> -zcvf dist.tar.gz *
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="增加2行代码" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/15/162c7bf8fa29ec6d~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p><p>\5. 点击构建后操作，增加构建后操作步骤，选择send build artificial over SSH， 参数说明：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>bash复制代码Name:选择一个你配好的ssh服务器
Source files ：写你要传输的文件路径
Remove prefix ：要去掉的前缀，不写远程服务器的目录结构将和Source files写的一致
Remote directory ：写你要部署在远程服务器的那个目录地址下，不写就是SSH Servers配置里默认远程目录
Exec <span class="token builtin class-name">command</span> ：传输完了要执行的命令，我这里执行了解压缩和解压缩完成后删除压缩包2个命令
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="参数说明" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/15/162c7c7caf0713f5~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p><p>\6. 现在当我们在本地将<code>Welcome to Your Vue.js App</code>修改为<code>Jenkins</code>后发出一个git push，过一会就会发现我们的服务器上已经部署好了最新的代码，是不是很6。</p><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="效果" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/15/162c7d37c88e9d5b~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p><p>至此，我们的自动化部署也完成了，但是如果过程中有异常怎么办，或是我们想知道每次Jenkins运行的日志及运行结果，我们可以通过配置邮件服务来让Jenkins每次完成任务后通知相关人员。</p><h2 id="实现邮件提醒" tabindex="-1"><a class="header-anchor" href="#实现邮件提醒" aria-hidden="true">#</a> 实现邮件提醒</h2><p>这里我们不用E-mail Notification，因为它的邮件服务功能太少，无法自定义邮件内容及自定义触发钩子，而且只能在异常情况下才能发邮件。我们使用Editable Email Notification这个。</p><ol><li><p>打开系统管理-系统配置-Extended E-mail Notification，不是系统管理-系统配置-邮件通知，千万不要配错了，否则不起作用。配置一下用来发邮件的邮箱，我这里用的是我自己的qq邮箱。</p><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="邮箱" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/15/162c7e1c8ac2aa01~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p><p>要是用别的厂家的邮箱服务就查下别的邮箱厂家smtp怎么配，用qq邮箱的除了user Name和password其他的和我写一样就行。另外password写的不是qq邮箱的密码，而是开启smtp服务后发短信获取的密码。</p></li><li><p>打开创建的那个任务，增加构建后操作步骤选择Editable Email Notification，Project Recipient List那里写你要发给谁邮件，可以多个，用分号隔开。</p></li></ol><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="邮件" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/15/162c7f232c5f77e8~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p><p>然后点击Advanced Settings-Triggers-Add Trigger，选择always，意思是无论什么情况任务执行完就发邮件，也可以选择其他模式，如任务执行异常了才发邮件。</p><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="发邮件" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/15/162c7f57bcfe4f46~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p><p>我这里配置的接收邮件的地址也是我的qq邮箱，这个可以根据自己公司的工作流程配。 \4. 现在当我们在本地修改代码后发出一个git push，Jenkins自动构建部署完成后就会给我发一封邮件，邮件附件里会有本次任务的日志。</p><p><img src="https://ooszy.cco.vin/img/blog-public/ljz.gif" alt="qq邮件" originSrc="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/4/15/162c7fe5e340972c~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image" data="aurora"></p><p>至此，我们的邮件提醒功能也配置完了。</p><h2 id="最后" tabindex="-1"><a class="header-anchor" href="#最后" aria-hidden="true">#</a> 最后</h2><p>通过上面这个案例，我们搭建了一套简单的自动化工作流，只需要在本地发起一个git提交，就可以在云端自动化构建，自动化部署，部署完成或出现异常后自动邮件通知，让持续集成、持续交付、持续部署变得简单易操作，解放了人力构建部署的生产力，也统一了构建环境，真实线上的CI服务配置比这个要复杂，大体流程可以参考下阮一峰老师的这篇文章:</p><p><a href="https://link.juejin.cn?target=http%3A%2F%2Fwww.ruanyifeng.com%2Fblog%2F2015%2F09%2Fcontinuous-integration.html" target="_blank" rel="noopener noreferrer">持续集成是什么？<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!----></span></a></p><p>Jenkins还有很多强大的特性，如Pipeline，slave等，插件也很丰富，社区生态也很好，如果公司暂时没有自行搭建CI服务的能力，使用免费开源的Jenkins是很好的选择。另外，如果你的项目是开源项目，也可以使用Travis CI做持续集成，这个配置起来比Jenkins简单，可以参考百度EFE的这篇文章：</p><p><a href="https://link.juejin.cn?target=http%3A%2F%2Fefe.baidu.com%2Fblog%2Ffront-end-continuous-integration-tools%2F" target="_blank" rel="noopener noreferrer">前端开源项目持续集成三剑客<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!----></span></a></p><p><strong>原文链接</strong>：https://juejin.cn/post/6844903591417757710</p><!--]--></div><footer class="page-meta"><div data="" class="meta-item edit-link"><!--[--><span class="aurora-nav-font aurora-navbar-icon"></span><a aria-current="page" href="/CICD/2023/20230515.html" class="router-link-active router-link-exact-active nav-link nav-link-active meta-item-label" aria-label></a><!--]--></div><!----><!----></footer><!--[--><!--]--></main><main style="--borderRadius:10px;--opacity:1;" class="page box"><div class="theme-default-content"><!--[--><div style="--homePageImgApi:url(https://www.dmoe.cc/random.php?return=text?time=-Infinity?time=-51143.5);" class="page-bottom-next"><div class="page-next-left page-next-item"><a aria-current="page" href="/CICD/2023/20230515.html" class="router-link-active router-link-exact-active"><span class="aurora-hover-color-animate"></span></a></div><!----></div><!--]--><!--[--><!--]--><!--[--><!--]--><!--[--><!--]--><!--[--><!--]--></div></main><div><!----></div><div class="recommend-page"><main style="--borderRadius:10px;--opacity:1;" class="page box"><h2 id="recommend-top-title">推荐阅读</h2><div id="recommend" class="recommend"><!--[--><!--]--></div></main></div><!----><!--]--><!--]--><!--[--><!--]--><!--[--><!--]--><!--[--><!--]--><!--[--><!--]--><!--[--><!--]--><!--[--><!--]--><!--[--><!--]--></div><div id="page-sidebar-right" style="" class="page-sidebar-right"><div class="stickSidebar"><!--[--><div class="sidebar-cqy"></div><div style="--borderRadius: 10px;--opacity: 1;" id="stickSidebar" class="sidebar-single-enter-animate"><div class="sidebarScroll home-sidebar" style="" id="home-sidebar"><div id="" class="sidebar-single-common"><div class="home-sidebar-avatar"><img id="home-sidebar-avatar-img" src="/avatar.jpg" alt=""></div><div class="home-sidebar-info-desc"><span>喜欢动漫，Coding目前是一名工作三年的前端工程师,坐标江西乐平</span></div><div class="home-sidebar-info-page"><div class="sidebar-page-common"><div>文章</div><div>34</div></div><div class="sidebar-page-common"><div>标签</div><div>15</div></div><div class="sidebar-page-common"><div>类别</div><div>13</div></div></div><a target="_blank" href="https://github.com/yuan5379/yuan5379.github.io"><div class="sidebar-github">Github</div></a><!--[--><!--]--></div><!--[--><!--]--><!----><!--[--><!--]--><div id="" class="sidebar-single-common"><div class="sidebar-link"><!--[--><!--]--></div></div><!----><!--[--><!--]--><!----><!--[--><!--]--><div id="" class="sidebar-single-enter-animate sidebar-single-page sidebar-single-common"><div class="change-page"><div class="catalog-page change-page-common"><span class="changePageActive" index="1">文章目录</span></div><div style="" class="latest-page change-page-common"><!----><span style="" class="" index="2">最新文章</span></div></div><div class="" style=""><!--[--><!--]--></div><div style="display:none;"><!--[--><!--]--></div><!--[--><!--]--></div><!--[--><!--]--><div id="" class="sidebar-single-enter-animate sidebar-single-common"><div class="sidebar-page"><span class="aurora-iconfont-common aurora-sidebar-message"></span><span>公告</span></div><div class="sidebar-message"><!--[--><li id="sidebar-message" class="sidebar-hover-bg-common"><span>暂无公告</span></li><!--]--></div><!--[--><!--]--></div><!--[--><!--]--><div id="" class="sidebar-single-enter-animate sidebar-single-common"><div id="home-tag-sidebar" class="sidebar-page"><span class="aurora-iconfont-common aurora-sidebar-tag"></span><span>标签</span></div><!----><div class="sidebar-tag-item"><!--[--><a href="/tag?tag=axios" class=""><div class="sidebar-tag-single"><span class="home-sidebar-tag-hover" style="color: #a9def9; font-size: 15px;">axios</span></div></a><a href="/tag?tag=CICD" class=""><div class="sidebar-tag-single"><span class="home-sidebar-tag-hover" style="color: #42bfdd; font-size: 15px;">CICD</span></div></a><a href="/tag?tag=css" class=""><div class="sidebar-tag-single"><span class="home-sidebar-tag-hover" style="color: #42bfdd; font-size: 28px;">css</span></div></a><a href="/tag?tag=html" class=""><div class="sidebar-tag-single"><span class="home-sidebar-tag-hover" style="color: #caf0f8; font-size: 29px;">html</span></div></a><a href="/tag?tag=canvas" class=""><div class="sidebar-tag-single"><span class="home-sidebar-tag-hover" style="color: #84dcc6; font-size: 33px;">canvas</span></div></a><a href="/tag?tag=react" class=""><div class="sidebar-tag-single"><span class="home-sidebar-tag-hover" style="color: #b8f2e6; font-size: 31px;">react</span></div></a><a href="/tag?tag=js" class=""><div class="sidebar-tag-single"><span class="home-sidebar-tag-hover" style="color: #aed9e0; font-size: 29px;">js</span></div></a><a href="/tag?tag=vue" class=""><div class="sidebar-tag-single"><span class="home-sidebar-tag-hover" style="color: #7ea8be; font-size: 28px;">vue</span></div></a><a href="/tag?tag=three" class=""><div class="sidebar-tag-single"><span class="home-sidebar-tag-hover" style="color: #8093f1; font-size: 27px;">three</span></div></a><a href="/tag?tag=基础" class=""><div class="sidebar-tag-single"><span class="home-sidebar-tag-hover" style="color: #fdc5f5; font-size: 29px;">基础</span></div></a><a href="/tag?tag=小程序" class=""><div class="sidebar-tag-single"><span class="home-sidebar-tag-hover" style="color: #8093f1; font-size: 34px;">小程序</span></div></a><a href="/tag?tag=工具" class=""><div class="sidebar-tag-single"><span class="home-sidebar-tag-hover" style="color: #62b6cb; font-size: 29px;">工具</span></div></a><a href="/tag?tag=面试" class=""><div class="sidebar-tag-single"><span class="home-sidebar-tag-hover" style="color: #75c9c8; font-size: 28px;">面试</span></div></a><!--]--></div><!--[--><!--]--></div><!--[--><!--]--><!----><!--[--><!--]--></div></div><!--]--></div></div></div></div></div><!--[--><!--]--><!--[--><!--]--><!--[--><!--]--><!--[--><!--]--><div style="--borderRadius:10px;--opacity:1;--fontColor:#2c3e50;--fontFamily:-apple-system;--fitter-blue:1px;" class="sidebar-single-enter-animate footer-layout-center" data-v-7e9b0cc5><div class="footer box" id="footer" data-v-7e9b0cc5><!--[--><div class="footer-item" id="footer-item" data-v-7e9b0cc5><span>Copyright © by qsyyke All Rights Reserved.</span></div><div class="footer-item" id="footer-item" data-v-7e9b0cc5><span><a target='_blank' href='http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=53060202000142' style='display:inline-block;text-decoration:none;height:20px;line-height:20px;'><img src='' style='float:left;'/><p style='float:left;height:20px;line-height:20px;margin: 0px 0px 0px 5px;'>滇公网安备 53060202000142号</p></a></span></div><div class="footer-item" id="footer-item" data-v-7e9b0cc5><span>theme&nbsp;<a href='https://github.com/vuepress-aurora/vuepress-theme-aurora' target='_blank'>Aurora</a>&nbsp;by&nbsp;<a href='https://aurora.xcye.xyz/' target='_blank'>qsyyke</a></span></div><!--]--><div class="footer-item" id="footer-item" data-v-7e9b0cc5><span data-v-7e9b0cc5>小破站已运行652天6小时52分3秒</span></div></div></div></div><div id="set-bg" class="set-bg-fitter" style="--opacity: 1; --borderRadius: 10px; --backgroundImageUrl: url()"></div><div id="posterShade" class=""><span class=""></span></div></div><!----><!--]--><!----><div class="no-aurora-music-box aurora-music-box"><div class="music-box"><div class="no-show-more-song music-more"><!--[--><div class="aurora-music-more-single"><span class="aurora-music-song-active aurora-music-font aurora-music-music1 aurora-music-song-info aurora-music-cursor aurora-music-song">12</span></div><div class="aurora-music-more-single"><span class="aurora-music-font aurora-music-music1 aurora-music-song-info aurora-music-cursor aurora-music-song">sdf</span></div><div class="aurora-music-more-single"><span class="aurora-music-font aurora-music-music1 aurora-music-song-info aurora-music-cursor aurora-music-song">34</span></div><!--]--></div><div class="music-player"><div class="aurora-music-pic-par"><div class="aurora-music-pic" id="aurora-music-pic"><div class="aurora-music-pause"><span class="aurora-music-bofang4 aurora-music-font aurora-music-control-pause aurora-music-cursor"></span></div><img src="https://p1.music.126.net/Rg1x9LeUacIDqtvUzL35Cw==/109951163688517312.jpg" alt=""></div></div><div class="aurora-music-info"><div class="aurora-music-info-left"></div><div class="aurora-music-info-right"><div class="aurora-music-title aurora-music-info-common"><span class="aurora-music-font aurora-music-music1 aurora-music-song-info aurora-music-cursor aurora-music-song">12</span></div><div class="aurora-music-bottom aurora-music-info-common"><div class="aurora-music-operate"><div><span class="aurora-music-font aurora-music-shangyishou1 aurora-music-cursor"></span></div></div><div class="aurora-music-operate"><div><span class="aurora-music-font aurora-music-xiayishou2 aurora-music-cursor"></span></div></div><div class="aurora-music-operate"><div><span class="aurora-music-geshunxubofang aurora-music-font aurora-music-cursor"></span></div></div><div class="aurora-music-operate"><div><span class="aurora-music-font aurora-music-gengduotianchong aurora-music-cursor aurora-music-operate-more"></span></div></div></div></div></div></div></div><audio class="aurora-music-player-control" controls="controls"><source src="" type="audio/mp3"> Your browser does not support this audio format. </audio></div><div class="aurora-bubble" style="--aurora-bubble-z-index:-2;" data-v-80e600c4><div class="aurora-bubble-box" id="aurora-bubble-box" data-v-80e600c4></div><canvas class="aurora-bubble-canvas" id="aurora-bubble-canvas" data-v-80e600c4></canvas></div><!--]--></div>
    <script src="/assets/js/runtime~app.c40023e3.js" defer></script><script src="/assets/js/4594.367318cd.js" defer></script><script src="/assets/js/app.60259080.js" defer></script>
  </body>
</html>
